[
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "# context_script\ncontext.services = frappe.get_all(\"HealthCare Services\", fields=[\"name\", \"price\"])\n",
  "css": ".appointment-container {\n    display: flex;\n    min-height: 100vh;\n}\nfooter {\n    display: none !important;\n}\nheader {\n    display: none !important;\n}\n\n.appointment-image {\n    flex: 1;\n    height: 100vh;\n    width: 100%;\n    background-image: url(\"/files/istockphoto-1331029732-612x612.jpg\"); /* No {{ }} */\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n}\n\n\n\n.overlay-text {\n    background: rgba(0, 0, 0, 0.5);\n    padding: 30px;\n    border-radius: 8px;\n    color: white;\n    text-align: center;\n    max-width: 100%;\n    \n}\n\n.overlay-text h1 {\n    font-size: 2rem;\n    margin-bottom: 10px;\n    color:#F2755F;\n}\n@media (min-width: 576px) {\n    h2 {\n        font-size: 2rem;\n        margin-top: 4rem;\n        margin-bottom: 0.75rem;\n        color:#F2755F;\n    }\n}\n.overlay-text p {\n    font-size: 1rem;\n    line-height: 1.5;\n    \n}\n\n/* Right side form */\n.appointment-form {\n    flex: 1;\n    max-width: 500px;\n    padding: 40px;\n    padding-top:0px;\n    background: #F2755F;\n    color: white;\n    border-radius: 0 8px 8px 0;\n}\n\n.appointment-form h2 {\n    text-align: center;\n    margin-bottom: 20px;\n    color: white;\n}\n\n.appointment-form label {\n    display: block;\n    margin-bottom: 6px;\n    font-weight: bold;\n    color: white;\n}\n\n.appointment-form input,\n.appointment-form select,\n.appointment-form button {\n    width: 100%;\n    padding: 10px;\n    margin-bottom: 14px;\n    border: 1px solid #ccc;\n    border-radius: 8px;\n    font-size: 14px;\n}\n\n.appointment-form button {\n    background-color: #4CAF50;\n    color: white;\n    font-weight: bold;\n    cursor: pointer;\n}\n\n.appointment-form button:hover {\n    background-color: #45a049;\n}\n",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 1,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "frappe.ready(function () {\n\n    function updateEndTimeAndValidate() {\n        let service = $('#serviceSelect').val();\n        let start_time = $('input[name=\"appointment_time\"]').val();\n        let appt_date = $('input[name=\"appointment_date\"]').val();\n\n        if (service && start_time && appt_date) {\n            // Step 1: calculate price and end_time\n            frappe.call({\n                method: \"healthcare_appointments.api.calculate_duration\",\n                args: {\n                    service: service,\n                    start_time: start_time\n                },\n                callback: function (r) {\n                    if (r.message) {\n                        $('#totalAmount').val(r.message.price || \"\");\n                        $('input[name=\"estimated_end_time\"]').val(r.message.end_time || \"\");\n\n                        // Step 2: validate the slot\n                        if (r.message.end_time) {\n                            frappe.call({\n                                method: \"healthcare_appointments.api.validate_slot_availability\",\n                                args: {\n                                    service: service,\n                                    appointment_date: appt_date,\n                                    start_time: start_time,\n                                    end_time: r.message.end_time\n                                },\n                                callback: function (res) {\n                                    if (res.message && !res.message.available) {\n                                        frappe.msgprint(res.message.message);\n                                        $('#totalAmount').val(\"\");\n                                        $('input[name=\"estimated_end_time\"]').val(\"\");\n                                    }\n                                }\n                            });\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    // Trigger when service, time, or date changes\n    $('#serviceSelect, input[name=\"appointment_time\"], input[name=\"appointment_date\"]').on('change', updateEndTimeAndValidate);\n\n    // Handle form submit\n    $('#appointmentForm').on('submit', function (e) {\n        e.preventDefault();\n\n        let formData = {\n            patient_name: $('input[name=\"patient_name\"]').val(),\n            mobile_number: $('input[name=\"mobile_number\"]').val(),\n            email: $('input[name=\"email\"]').val(),\n            appointment_date: $('input[name=\"appointment_date\"]').val(),\n            appointment_time: $('input[name=\"appointment_time\"]').val(),\n            service: $('#serviceSelect').val(),\n            estimated_end_time: $('input[name=\"estimated_end_time\"]').val(),\n            total_amount: $('#totalAmount').val()\n        };\n\n        frappe.call({\n            method: \"healthcare_appointments.api.create_appointment\",\n            args: formData,\n            callback: function (r) {\n                if (r.message && r.message.status === \"success\") {\n                    $('#responseMessage')\n                        .text(r.message.message)\n                        .css(\"color\", \"green\");\n                    $('#appointmentForm')[0].reset();\n                } else {\n                    $('#responseMessage')\n                        .text(\"Failed to book appointment. Please try again.\")\n                        .css(\"color\", \"red\");\n                }\n            }\n        });\n    });\n\n});\n",
  "main_section": null,
  "main_section_html": "<div class=\"appointment-container\">\n    <!-- Left side with image & text -->\n    <div class=\"appointment-image\">\n        <div class=\"overlay-text\">\n            <h2>Your Health, Our Priority</h2>\n            <p>Book your appointment today and get quality care from our trusted medical professionals.</p>\n        </div>\n    </div>\n\n    <!-- Right side with form -->\n    <div class=\"appointment-form\">\n        <h2>Book an Appointment</h2>\n        <form id=\"appointmentForm\">\n            <label for=\"patient_name\">Name</label>\n            <input type=\"text\" name=\"patient_name\" id=\"patient_name\" placeholder=\"Name\" required class=\"rounded-lg\">\n\n            <label for=\"mobile_number\">Mobile Number</label>\n            <input type=\"text\" name=\"mobile_number\" id=\"mobile_number\" placeholder=\"Mobile Number\" required class=\"rounded-lg\">\n\n            <label for=\"email\">Email</label>\n            <input type=\"email\" name=\"email\" id=\"email\" placeholder=\"Email\" class=\"rounded-lg\">\n\n            <label for=\"appointment_date\">Appointment Date</label>\n            <input type=\"date\" name=\"appointment_date\" id=\"appointment_date\" required class=\"rounded-lg\">\n\n            <label for=\"appointment_time\">Appointment Time</label>\n            <input type=\"time\" name=\"appointment_time\" id=\"appointment_time\" required class=\"rounded-lg\">\n\n            <label for=\"serviceSelect\">Service</label>\n            <select name=\"service\" id=\"serviceSelect\" required class=\"rounded-lg\">\n                <option value=\"\">Select Service</option>\n                {% for s in services %}\n                    <option value=\"{{ s.name }}\" data-price=\"{{ s.price }}\">\n                        {{ s.name }}\n                    </option>\n                {% endfor %}\n            </select>\n\n            <label for=\"estimated_end_time\">Estimated End Time</label>\n            <input type=\"time\" name=\"estimated_end_time\" id=\"estimated_end_time\" class=\"rounded-lg\">\n\n            <label for=\"totalAmount\">Total Amount</label>\n            <input type=\"number\" step=\"0.01\" name=\"total_amount\" id=\"totalAmount\" placeholder=\"Total Amount\" class=\"rounded-lg\">\n\n            <button type=\"submit\">Book Appointment</button>\n        </form>\n        <p id=\"responseMessage\"></p>\n    </div>\n</div>\n",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": "Healthcare Appointment",
  "modified": "2025-08-14 19:04:53.168963",
  "module": null,
  "name": "appointment-booking",
  "page_blocks": [],
  "published": 1,
  "route": "appointment-booking",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": "2025-08-13 16:55:41",
  "text_align": "Left",
  "title": "Appointment Booking",
  "website_sidebar": null
 }
]