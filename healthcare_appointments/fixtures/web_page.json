[
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "# context_script\ncontext.services = frappe.get_all(\"HealthCare Services\", fields=[\"name\", \"price\"])\n",
  "css": "/* Make entire page non-scrollable */\nhtml, body {\n    height: 100%;\n    margin: 0;\n    overflow: hidden;\n}\n\n.appointment-container {\n    display: flex;\n    height: 100vh;\n}\n\nfooter {\n    display: none !important;\n}\n\nheader {\n    display: none !important;\n}\n\n.appointment-image {\n    flex: 1;\n    height: 100vh;\n    background-image: url(\"/files/istockphoto-1331029732-612x612.jpg\");\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n    display: flex;\n    align-items: center; /* Vertical center */\n    justify-content: center;\n    position: relative;\n}\n\n/* Full-width overlay bar */\n.overlay-text {\n    position: absolute;\n    top: 16%;\n    left: 0;\n    transform: translateY(-50%);\n    width: 100%; /* Full width */\n    background: rgba(0, 0, 0, 0.5);\n    padding: 30px 20px;\n    color: white;\n    text-align: center;\n}\n\n.overlay-text h2 {\n    font-size: 2rem;\n    margin-bottom: 10px;\n    color: #F2755F;\n}\n\n.overlay-text p {\n    font-size: 1rem;\n    line-height: 1.5;\n}\n\n/* Right side form scrollable */\n.appointment-form {\n    flex: 1;\n    max-width: 500px;\n    background: #F2755F;\n    color: white;\n    border-radius: 0 8px 8px 0;\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto; /* Enable scroll only for form panel */\n    height: 100vh; /* Fill viewport */\n    padding: 40px;\n    padding-top: 0px;\n}\n\n.appointment-form h2 {\n    text-align: center;\n    margin-bottom: 20px;\n    color: white;\n}\n\n.appointment-form label {\n    display: block;\n    margin-bottom: 6px;\n    font-weight: bold;\n    color: white;\n}\n\n.appointment-form input,\n.appointment-form select,\n.appointment-form button {\n    width: 100%;\n    padding: 10px;\n    margin-bottom: 14px;\n    border: 1px solid #ccc;\n    border-radius: 8px;\n    font-size: 14px;\n}\n\n.appointment-form button {\n    background-color: #4CAF50;\n    color: white;\n    font-weight: bold;\n    cursor: pointer;\n}\n\n.appointment-form button:hover {\n    background-color: #45a049;\n}\n",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 1,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "frappe.ready(function () {\n\n    function updateEndTimeAndValidate() {\n        let service = $('#serviceSelect').val();\n        let start_time = $('input[name=\"appointment_time\"]').val();\n        let appt_date = $('input[name=\"appointment_date\"]').val();\n\n        if (service && start_time && appt_date) {\n            // Step 1: calculate price and end_time\n            frappe.call({\n                method: \"healthcare_appointments.api.calculate_duration\",\n                args: {\n                    service: service,\n                    start_time: start_time\n                },\n                callback: function (r) {\n                    if (r.message) {\n                        $('#totalAmount').val(r.message.price || \"\");\n                        $('input[name=\"estimated_end_time\"]').val(r.message.end_time || \"\");\n\n                        // Step 2: validate the slot\n                        if (r.message.end_time) {\n                            frappe.call({\n                                method: \"healthcare_appointments.api.validate_slot_availability\",\n                                args: {\n                                    service: service,\n                                    appointment_date: appt_date,\n                                    start_time: start_time,\n                                    end_time: r.message.end_time\n                                },\n                                callback: function (res) {\n                                    if (res.message && !res.message.available) {\n                                        frappe.msgprint(res.message.message);\n                                        $('#totalAmount').val(\"\");\n                                        $('input[name=\"estimated_end_time\"]').val(\"\");\n                                    }\n                                }\n                            });\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    // Trigger when service, time, or date changes\n    $('#serviceSelect, input[name=\"appointment_time\"], input[name=\"appointment_date\"]').on('change', updateEndTimeAndValidate);\n\n    // Handle form submit\n    $('#appointmentForm').on('submit', function (e) {\n        e.preventDefault();\n\n        let formData = {\n            patient_name: $('input[name=\"patient_name\"]').val(),\n            mobile_number: $('input[name=\"mobile_number\"]').val(),\n            email: $('input[name=\"email\"]').val(),\n            appointment_date: $('input[name=\"appointment_date\"]').val(),\n            appointment_time: $('input[name=\"appointment_time\"]').val(),\n            service: $('#serviceSelect').val(),\n            estimated_end_time: $('input[name=\"estimated_end_time\"]').val(),\n            total_amount: $('#totalAmount').val()\n        };\n\n        frappe.call({\n            method: \"healthcare_appointments.api.create_appointment\",\n            args: formData,\n            callback: function (r) {\n                if (r.message && r.message.status === \"success\") {\n                    $('#responseMessage')\n                        .text(r.message.message)\n                        .css(\"color\", \"green\");\n                    $('#appointmentForm')[0].reset();\n                } else {\n                    $('#responseMessage')\n                        .text(\"Failed to book appointment. Please try again.\")\n                        .css(\"color\", \"red\");\n                }\n            }\n        });\n    });\n\n});\n",
  "main_section": null,
  "main_section_html": "<div class=\"appointment-container\">\n    <!-- Left side with image & text -->\n    <div class=\"appointment-image\">\n        <div class=\"overlay-text\">\n            <h2>Your Health, Our Priority</h2>\n            <p>Book your appointment today and get quality care from our trusted medical professionals.</p>\n        </div>\n    </div>\n\n    <!-- Right side with form -->\n    <div class=\"appointment-form\">\n        <h2>Book an Appointment</h2>\n        <form id=\"appointmentForm\">\n            <label for=\"patient_name\">Name</label>\n            <input type=\"text\" name=\"patient_name\" id=\"patient_name\" placeholder=\"Name\" required class=\"rounded-lg\">\n\n            <label for=\"mobile_number\">Mobile Number</label>\n            <input type=\"text\" name=\"mobile_number\" id=\"mobile_number\" placeholder=\"Mobile Number\" required class=\"rounded-lg\">\n\n            <label for=\"email\">Email</label>\n            <input type=\"email\" name=\"email\" id=\"email\" placeholder=\"Email\" class=\"rounded-lg\">\n\n            <label for=\"appointment_date\">Appointment Date</label>\n            <input type=\"date\" name=\"appointment_date\" id=\"appointment_date\" required class=\"rounded-lg\">\n\n            <label for=\"appointment_time\">Appointment Time</label>\n            <input type=\"time\" name=\"appointment_time\" id=\"appointment_time\" required class=\"rounded-lg\">\n\n            <label for=\"serviceSelect\">Service</label>\n            <select name=\"service\" id=\"serviceSelect\" required class=\"rounded-lg\">\n                <option value=\"\">Select Service</option>\n                {% for s in services %}\n                    <option value=\"{{ s.name }}\" data-price=\"{{ s.price }}\">\n                        {{ s.name }}\n                    </option>\n                {% endfor %}\n            </select>\n\n            <label for=\"estimated_end_time\">Estimated End Time</label>\n            <input type=\"time\" name=\"estimated_end_time\" id=\"estimated_end_time\" class=\"rounded-lg\">\n\n            <label for=\"totalAmount\">Total Amount</label>\n            <input type=\"number\" step=\"0.01\" name=\"total_amount\" id=\"totalAmount\" placeholder=\"Total Amount\" class=\"rounded-lg\">\n\n            <button type=\"submit\">Book Appointment</button>\n        </form>\n        <p id=\"responseMessage\"></p>\n    </div>\n</div>\n",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": "Healthcare Appointment",
  "modified": "2025-08-15 16:14:21.744459",
  "module": null,
  "name": "appointment-booking",
  "page_blocks": [],
  "published": 1,
  "route": "appointment-booking",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": "2025-08-13 16:55:41",
  "text_align": "Left",
  "title": "Appointment Booking",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "services = frappe.get_all(\n    \"HealthCare Services\",\n    fields=[\"service_name\", \"name\", \"price\", \"duration_minutes\", \"description\", \"status\"]\n)\n\n# Convert duration to minutes for display in form\nfor s in services:\n    try:\n        if isinstance(s.duration_minutes, str) and \":\" in s.duration_minutes:\n            h, m, sec = s.duration_minutes.split(\":\")\n            s.duration_minutes = int(h) * 60 + int(m)\n    except:\n        pass\n\ncontext.services = services or []\n",
  "css": "/* Container background */\n.page-bg {\n  position: relative;\n  height: 100%;\n  width: 100%;\n  background-size: cover;\n  background-position: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\nhtml, body {\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    overflow: hidden; /* Remove scroll from page */\n}\n\n.form-container {\n    height: 100vh; /* Full screen height */\n    overflow-y: auto; /* Scroll only inside the form */\n    padding: 20px;\n    box-sizing: border-box;\n}\n\n\n/* White card container */\n.card-wrapper {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  background: white;\n  width: calc(100vw - 60px);\n  height: calc(100vh - 30%);\n  border-radius: 0.5rem;\n}\n.service-card {\n    height: 130px;\n    overflow: hidden; /* Hide extra text if longer */\n}\n\n/* Header bar */\n.header-bar {\n  width: 100%;\n  height: 10%;\n  display: flex;\n  align-items: center;\n  background: #E9EAEB;\n  padding: 0.5rem 1rem;\n  gap: 1rem;\n  border-radius: 0.5rem;\n}\n\n.header-title {\n  font-size: 1.125rem;\n  font-weight: 500;\n  color: #374151;\n}\n\n/* Stats box */\n.stats-box {\n  display: flex;\n  align-items: center;\n  background: white;\n  border-radius: 0.5rem;\n  padding: 0.25rem 0.75rem;\n  color: #374151;\n  font-size: 0.875rem;\n  margin-left: auto;\n}\n\n.stats-box span {\n  margin-left: 0.25rem;\n  font-weight: bold;\n}\n\n/* Cards area */\n.cards-container {\n  width: 100%;\n  background: white;\n  padding: 0.75rem;\n  border-radius: 0.5rem;\n  overflow-y: auto;\n  flex: 1;\n}\n\nfooter {\n    display: none !important;\n}\nheader {\n    display: none !important;\n}\n.cards-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 1rem;\n}\n\n.card {\n  border: 1px solid #D1D5DB;\n  border-radius: 0.5rem;\n  padding: 1rem;\n  background: #F9FAFB;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n}\n\n.card:hover {\n  border-color: #4D8C52;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.5rem;\n}\n\n.card-title {\n  font-weight: 500;\n  font-size: 1.125rem;\n  color: #374151;\n}\n\n.card-status {\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.25rem;\n  font-size: 0.875rem;\n  background: #E5E7EB;\n  color: #4B5563;\n}\n\n.card-info {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.875rem;\n  color: #374151;\n}\n\n.card-desc {\n  font-size: 0.875rem;\n  color: #4B5563;\n  margin-top: 0.5rem;\n  display: -webkit-box;\n  -webkit-line-clamp: 2; /* Limit text to 2 lines */\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "frappe.ready(function() {\r\n    document.querySelectorAll('.service-card').forEach(card => {\r\n        card.addEventListener('click', function() {\r\n            let service = JSON.parse(this.dataset.item);\r\n            openModal(service);\r\n        });\r\n    });\r\n});\r\n\r\nfunction openModal(service) {\r\n    document.getElementById('modalTitle').textContent = service.service_name;\r\n    document.getElementById('modalServiceName').classList.add('hidden'); // hide service name for edit\r\n    document.getElementById('modalStatus').value = service.status;\r\n    document.getElementById('modalDuration').value = service.duration_minutes;\r\n    document.getElementById('modalPrice').value = service.price;\r\n    document.getElementById('modalDescription').value = service.description || \"\";\r\n    document.getElementById('serviceModal').dataset.docname = service.name;\r\n    document.getElementById('serviceModal').classList.remove('hidden');\r\n}\r\n\r\nfunction openNewServiceModal() {\r\n    document.getElementById('modalTitle').textContent = \"New Service\";\r\n    document.getElementById('modalServiceName').value = \"\";\r\n    document.getElementById('modalServiceName').classList.remove('hidden'); // show service name for new\r\n    document.getElementById('modalStatus').value = \"Active\";\r\n    document.getElementById('modalDuration').value = \"\";\r\n    document.getElementById('modalPrice').value = \"\";\r\n    document.getElementById('modalDescription').value = \"\";\r\n    document.getElementById('serviceModal').dataset.docname = \"\";\r\n    document.getElementById('serviceModal').classList.remove('hidden');\r\n}\r\n\r\nfunction closeModal() {\r\n    document.getElementById('serviceModal').classList.add('hidden');\r\n}\r\n\r\nfunction saveService() {\r\n    let docname = document.getElementById('serviceModal').dataset.docname;\r\n\r\n    let minutes = parseInt(document.getElementById('modalDuration').value) || 0;\r\n    let hours = Math.floor(minutes / 60);\r\n    let mins = minutes % 60;\r\n    let duration_str = String(hours).padStart(2, '0') + \":\" + String(mins).padStart(2, '0') + \":00\";\r\n\r\n    let serviceData = {\r\n        \"status\": document.getElementById('modalStatus').value,\r\n        \"duration_minutes\": duration_str,\r\n        \"price\": parseFloat(document.getElementById('modalPrice').value) || 0,\r\n        \"description\": document.getElementById('modalDescription').value\r\n    };\r\n\r\n    if (docname) {\r\n        // Edit existing service\r\n        frappe.call({\r\n            method: \"frappe.client.set_value\",\r\n            args: {\r\n                doctype: \"HealthCare Services\",\r\n                name: docname,\r\n                fieldname: serviceData\r\n            },\r\n            callback: function(r) {\r\n                if (!r.exc) {\r\n                    frappe.msgprint(\"Service updated successfully!\");\r\n                    closeModal();\r\n                    location.reload();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        // Create new service\r\n        let serviceName = document.getElementById('modalServiceName').value.trim();\r\n        if (!serviceName) {\r\n            frappe.msgprint(\"Service name is required!\");\r\n            return;\r\n        }\r\n        serviceData[\"service_name\"] = serviceName;\r\n\r\n        frappe.call({\r\n            method: \"frappe.client.insert\",\r\n            args: {\r\n                doc: {\r\n                    doctype: \"HealthCare Services\",\r\n                    ...serviceData\r\n                }\r\n            },\r\n            callback: function(r) {\r\n                if (!r.exc) {\r\n                    frappe.msgprint(\"New service created successfully!\");\r\n                    closeModal();\r\n                    location.reload();\r\n                }\r\n            }\r\n        });\r\n    }\r\n}",
  "main_section": null,
  "main_section_html": "<link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\r\n\r\n<div class=\"h-screen flex\">\r\n    <!-- Left Side: Healthcare Services -->\r\n    <div class=\"flex-1 flex flex-col bg-white\">\r\n        <!-- Header -->\r\n        <div class=\"w-full rounded-lg h-[10%] flex items-center bg-[#E9EAEB] px-4 py-2 gap-4\">\r\n            <div class=\"text-lg font-medium text-gray-700\">HealthCare Services</div>\r\n            <div class=\"flex items-center gap-2 ml-auto\">\r\n                <div class=\"flex items-center bg-white rounded-lg px-3 py-2 text-gray-700 text-sm\">\r\n                    Total services\r\n                    <span class=\"ml-1 font-bold\">{{ services | length }}</span>\r\n                </div>\r\n                <button onclick=\"openNewServiceModal()\" class=\"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\">\r\n                    New Service\r\n                </button>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Cards Grid -->\r\n        <div class=\"grid grid-cols-4 gap-4 p-4 pb-0 flex-1\">\r\n            {% for item in services %}\r\n                <div class=\"border rounded-lg p-4 bg-gray-50 cursor-pointer transition-all border-gray-300 service-card\"\r\n                     data-item='{{ {\r\n                       \"name\": item.name,\r\n                       \"service_name\": item.service_name,\r\n                       \"duration_minutes\": item.duration_minutes|string,\r\n                       \"status\": item.status,\r\n                       \"price\": item.price,\r\n                       \"description\": item.description\r\n                     } | tojson }}'>\r\n\r\n                    <div class=\"flex justify-between items-start mb-2\">\r\n                        <h2 class=\"font-medium text-lg text-gray-700\">\r\n                            {{ item.service_name }}\r\n                        </h2>\r\n                        <span class=\"px-2 py-1 rounded text-sm bg-gray-200 text-gray-600\">\r\n                            {{ item.status }}\r\n                        </span>\r\n                    </div>\r\n                    <div class=\"flex justify-between text-sm text-gray-700\">\r\n                        <span>Duration: <strong>{{ item.duration_minutes }} mins</strong></span>\r\n                        <span>Price: <strong>\u20b9{{ item.price }}</strong></span>\r\n                    </div>\r\n                    <p class=\"text-sm text-gray-600 mt-2 line-clamp-2\">\r\n                        {{ item.description }}\r\n                    </p>\r\n                </div>\r\n            {% endfor %}\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Modal -->\r\n<div id=\"serviceModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden\">\r\n  <div class=\"bg-white rounded-lg p-6 w-1/3\">\r\n    <h2 id=\"modalTitle\" class=\"text-xl font-semibold mb-2\"></h2>\r\n\r\n    <!-- Service Name Field (only visible for new service) -->\r\n    <input id=\"modalServiceName\" type=\"text\" class=\"border w-full p-2 mb-2 hidden\" placeholder=\"Service Name\">\r\n\r\n    <!-- Status Dropdown -->\r\n    <select id=\"modalStatus\" class=\"border w-full p-2 mb-2\">\r\n      <option value=\"Active\">Active</option>\r\n      <option value=\"In-Active\">In-Active</option>\r\n    </select>\r\n\r\n    <input id=\"modalDuration\" type=\"number\" min=\"0\" class=\"border w-full p-2 mb-2\" placeholder=\"Duration (mins)\">\r\n    <input id=\"modalPrice\" type=\"number\" class=\"border w-full p-2 mb-2\" placeholder=\"Price\">\r\n    <textarea id=\"modalDescription\" class=\"border w-full p-2 mb-4\" placeholder=\"Description\"></textarea>\r\n\r\n    <div class=\"flex justify-end gap-2\">\r\n      <button onclick=\"closeModal()\" class=\"px-4 py-2 bg-gray-300 rounded\">Close</button>\r\n      <button onclick=\"saveService()\" class=\"px-4 py-2 bg-green-600 text-white rounded\">Save</button>\r\n    </div>\r\n  </div>\r\n</div>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-15 18:07:45.803319",
  "module": null,
  "name": "healthcare-services",
  "page_blocks": [],
  "published": 1,
  "route": "services",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "HealthCare Services",
  "website_sidebar": null
 }
]